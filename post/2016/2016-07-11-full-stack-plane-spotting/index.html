<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="full stack plane spotting and data analysis"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@vielmetti"/>



  	<meta property="og:title" content="full stack plane spotting and data analysis &middot; Vacuum weblog from Edward Vielmetti" />
  	<meta property="og:site_name" content="Vacuum weblog from Edward Vielmetti" />
  	<meta property="og:url" content="http://vielmetti.github.io/post/2016/2016-07-11-full-stack-plane-spotting/" />

    
        
            <meta property="og:image" content="http://vielmetti.github.ioimages/cover.jpg"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="og:image" content="http://vielmetti.github.io" />
    <meta property="article:published_time" content="2016-07-11T13:30:00-04:00" />

    
    <meta property="article:tag" content="Node-RED" />
    
    <meta property="article:tag" content="Raspberry Pi" />
    
    <meta property="article:tag" content="radio" />
    
    <meta property="article:tag" content="dump1090" />
    
    <meta property="article:tag" content="dump1090-mutability" />
    
    <meta property="article:tag" content="ADS-B" />
    
    <meta property="article:tag" content="Docker" />
    
    <meta property="article:tag" content="Docker for Mac" />
    
    <meta property="article:tag" content="Kitematic" />
    
    <meta property="article:tag" content="Hypriot" />
    
    <meta property="article:tag" content="OpenLayers" />
    
    <meta property="article:tag" content="OpenVPN" />
    
    <meta property="article:tag" content="lighttpd" />
    
    <meta property="article:tag" content="Planefinder" />
    
    <meta property="article:tag" content="Pi 2" />
    
    <meta property="article:tag" content="worldmap" />
    
    <meta property="article:tag" content="Jared Mauch" />
    
    <meta property="article:tag" content="Phil Karn" />
    
    

    <title>full stack plane spotting and data analysis &middot; Vacuum weblog from Edward Vielmetti</title>

    
    <meta name="description" content="" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="http://vielmetti.github.ioimages/favicon.ico">
	  <link rel="apple-touch-icon" href="http://vielmetti.github.ioimages/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="http://vielmetti.github.iocss/screen.css" />
    <link rel="stylesheet" type="text/css" href="http://vielmetti.github.iocss/nav.css" />

    

    
      
          <link href="http://vielmetti.github.ioindex.xml" rel="alternate" type="application/rss+xml" title="Vacuum weblog from Edward Vielmetti" />
      
      
    
    <meta name="generator" content="Hugo 0.20" />

    <link rel="canonical" href="http://vielmetti.github.io/post/2016/2016-07-11-full-stack-plane-spotting/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": 
    },
    "author": {
        "@type": "Person",
        "name": ,
        
        "url": ,
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": full stack plane spotting and data analysis,
    "name": full stack plane spotting and data analysis,
    "wordCount": 1216,
    "timeRequired": "PT6M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": en
    },
    "url": http://vielmetti.github.io/post/2016/2016-07-11-full-stack-plane-spotting/,
    "datePublished": 2016-07-11T13:30Z,
    "dateModified": 2016-07-11T13:30Z,
    
    "keywords": Node-RED, Raspberry Pi, radio, dump1090, dump1090-mutability, ADS-B, Docker, Docker for Mac, Kitematic, Hypriot, OpenLayers, OpenVPN, lighttpd, Planefinder, Pi 2, worldmap, Jared Mauch, Phil Karn,
    "description": ,
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": http://vielmetti.github.io/post/2016/2016-07-11-full-stack-plane-spotting/
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-83143-8', 'auto');
      ga('send', 'pageview');

    </script>
    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        

        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://vielmetti.github.io/post/about-this-weblog/">About this weblog</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://vielmetti.github.io/post/2011/2011-11-20-moon-maps-lroc/">New map of the dark side of the moon from the Lunar Reconnaissance Orbiter Camera (LROC)</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://vielmetti.github.io/post/2011/2011-06-09-power-outage-maps/">Power outage maps for all 50 states plus as many other countries as I can find</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://vielmetti.github.io/post/2015/2015-11-01-slack-vs-irc/">Slack vs IRC</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://vielmetti.github.io/post/2014/2014-04-04-tune-in-to-skywarn-nets-in-50-states-when-severe-weather-threatens/">Tune in to Skywarn nets in 50 states when severe weather threatens</a>
            </li>
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="http://vielmetti.github.ioindex.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">full stack plane spotting and data analysis</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2016-07-11T13:30:00-04:00">
            Jul 11, 2016
          </time>
        
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/node-red/">#Node-RED</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/raspberry-pi/">#Raspberry Pi</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/radio/">#radio</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/dump1090/">#dump1090</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/dump1090-mutability/">#dump1090-mutability</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/ads-b/">#ADS-B</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/docker/">#Docker</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/docker-for-mac/">#Docker for Mac</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/kitematic/">#Kitematic</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/hypriot/">#Hypriot</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/openlayers/">#OpenLayers</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/openvpn/">#OpenVPN</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/lighttpd/">#lighttpd</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/planefinder/">#Planefinder</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/pi-2/">#Pi 2</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/worldmap/">#worldmap</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/jared-mauch/">#Jared Mauch</a></span>
         
          <span class="post-tag small"><a href="http://vielmetti.github.iotags/phil-karn/">#Phil Karn</a></span>
         
        </section>
    </header>

    <section class="post-content">
      

<p>The task at hand is simple. Whenever a particular airplane is visible overhead,
send out a tweet with that notice. Don&rsquo;t repeat yourself with this announcement
more than twice an hour, but try not to have too much lag in reporting.</p>

<p>The full stack of hardware and software to do this is not particularly
complicated to use once you get it all running, but there are a series
of issues and observations along the way that add to the complexity. I&rsquo;ll
walk through the whole thing start to finish, and let you know where I
left off.</p>

<p>The basic toolkit is dump1090-mutability for plane spotting,
Node-RED for wiring flows for data processing, and
Docker to package up the bits that are stable.</p>

<h2 id="plane-spotting">Plane spotting</h2>

<p><a href="http://vielmetti.github.io/post/2016/2016-07-02-plane-finding-with-dump1090/">When last I wrote</a>,
I had <a href="http://github.com/mutability/dump1090">dump1090</a>
running on my MacBook. Since then, I&rsquo;ve taken the same software and gotten
the latest dev release going on a Raspberry Pi 2.</p>

<p>I switched to a smaller, simpler antenna, and the result was positive: instead of
having a 40 to 50 nautical mile range, now I&rsquo;m in the 60 to 65 nm range (about 110 km).
It might also help that the Pi 2 is not really doing very much else. That
particular Pi 2 setup is using a slightly back-rev version of the
<a href="http://blog.hypriot.com">Hypriot</a> software for the Pi, so it has all
of the modern conveniences plus an instance of Docker on board. The
temptation was to Dockerize everything, but I haven&rsquo;t gone there yet;
the available Docker prebuilt releases don&rsquo;t have the bleeding edge of
the dump1090-mutability code, and I want to see how the whole thing runs
native for a while before containerizing it.</p>

<p>The snag that slowed down this deployment a little was Google&rsquo;s decision
to enforce an API key for personal use of Google Maps. In response, the
very latest dump1090-mutability pulled out its Google Maps support, and
went to <a href="http://openlayers.org/">OpenLayers</a>. This new support gives
access to all kinds of base maps, including some aviation-specific
charts. (&ldquo;Not for use in navigation.&rdquo;)</p>

<p>Another piece of this was bringing up <a href="http://www.lighttpd.net/">lighttpd</a>
(&ldquo;lighty&rdquo;), a lightweight HTTP server that replaces the rickety
built-in HTTP server that dump1090 had originally shipped with.
Configuration following the supplied instructions was simple,
and lighttpd looks like a very suitable system to put in place to
serve HTTP on embedded-class system that need flexiblity but not
a big footprint.</p>

<p>The other component in the Pi setup is an ADS-B feed to the excellent
<a href="http://planefinder.net">Planefinder</a> site. Planefinder provides a Debian
package for setting up the feed, and it runs neatly with only a minimum
of overhead. As a bonus you get free use of their apps, which are
notable for running in much closer to real time than others I have seen.</p>

<p>The Pi does not yet have a working OpenVPN configuration, so I can&rsquo;t get
to it over the net directly. For that I plan to revisit the
<a href="http://vielmetti.github.io/post/2015/2015-09-07-managing-raspberry-pi-openvpn-with-salt/">SaltStack for Pi</a>
configuration I wrote up last September. In the interim, salt has
been upgraded, and perhaps it will be a little more stable over bad
connections; we&rsquo;ll see.</p>

<h2 id="data-analysis">Data analysis</h2>

<p>dump1090 provides a data feed in a convenient JSON format, available
through a URL on a standard configuruation. The ADS-B messages themselves
are binary encoded, but the system brings them into JSON so that all
of the downstream processing is very easy.</p>

<p>Data handling is so straightforward that you can do it all without
needing any special-purpose processing nodes in IBM&rsquo;s <a href="http://nodered.org">Node-RED</a>.
A standard HTTP in node polls the data at the pace that you choose,
and a simple function pulls apart the record of all planes into
individual records for each plane.</p>

<p>Getting Node-RED running is continuing to get easier over time.
I&rsquo;m doing prototyping work on my Macintosh again, using the
new <a href="https://blog.docker.com/2016/06/docker-mac-windows-public-beta/">Docker for Mac</a>
setup to pick up a <a href="https://hub.docker.com/r/cpswan/node-red/">Node-RED container</a>
to do the work in. <a href="https://kitematic.com/">Kitematic</a> comes with Docker for Mac,
providing a convenient dashboard and interface to Docker Hub.</p>

<p>(Do note, however, that if you got Docker for Mac running a few months
ago, you&rsquo;ll need to go through a rebuild process to go to the latest
beta. To <a href="https://docs.docker.com/docker-for-mac/troubleshoot/#/recreate-or-update-your-containers-after-beta-18-upgrade">recreate or update your containers after Beta 18 upgrade</a>
follow the provided instructions.)</p>

<p>Once you have both Node-RED and dump1090 running, connecting the
two together is straightforward. I started with this
<a href="https://gist.github.com/dceejay/3288996fefdc3aef04846496277b6444">gist from dceejay</a> which
provides the basic flow and feeds into a
<a href="http://flows.nodered.org/node/node-red-contrib-web-worldmap">worldmap node</a> that
is a general programmable interface for putting things on a map. My
<a href="https://gist.github.com/vielmetti/6329ea5a49dadd2f106980a20727d16e">updated dump1090 gist for Node-RED</a>
adapts the data for a slightly different format between dump1090 forks.</p>

<p>From here in it&rsquo;s relatively clear sailing. Set up a flow downstream
from the plane messages, using a filter node to match the name or
ICAO hex code of the airplane that you want to track. Wire it through
a delay filter to set the frequency of messages you want to
allow through, and a formatting node to pretty up the message in
a form suitable for Twitter output.</p>

<h2 id="incomplete-image-and-next-steps">Incomplete image and next steps.</h2>

<p>This is a relatively complex stack, but it all fits neatly on a Raspberry Pi 2,
and with a little bit more elbow grease it should be possible to containerize
everything so that it Just Works and can be made to reliably work again.</p>

<p>I&rsquo;d like to have OpenVPN running on the Pi 2, but it isn&rsquo;t yet, pending
rework of Salt to get that to a current version and to port all of the
work I did from an earlier version.</p>

<p>I&rsquo;m picking up planes from 60+ nm away, but I know that with a better
antenna, bandpass filter, and amplifier that I can do better.
<a href="https://puck.nether.net/~jared/blog/?p=160">Jared Mauch&rsquo;s parts list</a>
would be the place to go for starters with a very modest budget of
a couple of hundred bucks.</p>

<p>Reception is best if you have a clear view of the sky, which suggests
an outdoors installation, powering the Pi with power over ethernet.</p>

<p>The system is running on a Pi 2, but reports from Jared and from Phil Karn KA9Q
suggest that if you do upgrade the reception that it&rsquo;s possible to
saturate the Pi 2. Fortunately a Pi 3 does even better at the intended task.</p>

<p>I&rsquo;m still figuring out what the very best way to create a Docker image
that handles Node-RED, especially the installation of additional nodes
and the management of flows. You&rsquo;d like to have the whole thing suitably
tidy that it could be all loaded in from the get-go.</p>

<p>dump1090-mutability is still mutating! It&rsquo;s under active development,
both at the presentation layer and at the decoder layer. So it would
be appropriate to have the attitude for at least one development machine
to be sure that you were ready to rebuild from source whenever.</p>

<p>If you only have half of this stack running (the Node-RED side) but no access
to radios, you can find an existing dump1090 installation and pull the
JSON from there. This is best done only via prior arrangement and only
for testing purposes or for specific tasks. It&rsquo;s easy to crank up Node-RED
to poll a URL every second; don&rsquo;t do that to a poor little Pi.</p>

<p>The planes I want to watch don&rsquo;t take off very often - that&rsquo;s the appeal
of watching for them.</p>

    </section>


  <footer class="post-footer">


    

    





<section class="author">
  <h4><a href="http://vielmetti.github.io">Edward Vielmetti</a></h4>
  
  <p>Read <a href="http://vielmetti.github.io">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Ann Arbor, Michigan</span>
    
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=full%20stack%20plane%20spotting%20and%20data%20analysis&nbsp;-&nbsp;Vacuum%20weblog%20from%20Edward%20Vielmetti&amp;url=http%3a%2f%2fvielmetti.github.io%2fpost%2f2016%2f2016-07-11-full-stack-plane-spotting%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fvielmetti.github.io%2fpost%2f2016%2f2016-07-11-full-stack-plane-spotting%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2fvielmetti.github.io%2fpost%2f2016%2f2016-07-11-full-stack-plane-spotting%2f&amp;description=full%20stack%20plane%20spotting%20and%20data%20analysis"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=http%3a%2f%2fvielmetti.github.io%2fpost%2f2016%2f2016-07-11-full-stack-plane-spotting%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    




  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="http://vielmetti.github.io/post/2016/2016-09-05-new-month-new-theme/">
          <section class="post">
              <h2>New month, new theme</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="http://vielmetti.github.io/post/2016/2016-07-02-plane-finding-with-dump1090/">
          <section class="post">
              <h2>Plane finding with dump1090</h2>
          </section>
      </a>
  
</aside>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Vacuum weblog from Edward Vielmetti</a> </section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="http://vielmetti.github.iojs/jquery.js"></script>
    <script type="text/javascript" src="http://vielmetti.github.iojs/jquery.fitvids.js"></script>
    <script type="text/javascript" src="http://vielmetti.github.iojs/index.js"></script>
    
</body>
</html>

